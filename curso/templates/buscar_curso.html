{% extends "base_nav.html" %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/buscar.css' %}">
<div class="container">
  <!-- Botón volver -->
  <a href="{% url 'dashboard' %}" class="back-link">← Volver al Dashboard</a>

  <!-- Encabezado -->
  <h1>Buscar Cursos</h1>
  <p class="subtitle">Explora todos los cursos disponibles en el sistema</p>

  <!-- Barra de búsqueda -->
  <form method="get" class="search-bar">
    <input type="text" name="q" placeholder="Buscar por programa, municipio, instructor o modalidad..." value="{{ q }}">
    <button type="submit">Buscar</button>
  </form>

  <!-- Resultados -->
  <h2 class="results-title">Cursos Encontrados ({{ courses|length }})</h2>

  {% if not q %}
    <div class="alert info">Realiza una búsqueda para ver los resultados aquí!!</div>
  {% elif not courses %}
    <div class="alert error">No se encontraron cursos</div>
  {% else %}
    <div class="table-container">
      <table class="results-table">
        <thead>
          <tr>
            <th>Programa</th>
            <th>Código</th>
            <!-- <th>Duración</th> -->
            <th>Instructor</th>
            <th>Inicio</th>
            <th>Fin</th>
            <th>Estado</th>
            <th>Inscritos</th>
            <th>Inscripción</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          {% for course in courses %}
          <tr>
            <td>{{ course.programa.nombre }}</td>
            <td>{{ course.programa.codigo }}</td>
            <!-- <td>{{ course.programa.duracion }}</td> -->
            <td>{{ course.usuario.first_name }} {{ course.usuario.last_name }}</td>
            <td>{{ course.fecha_inicio|date:"d/m/Y" }}</td>
            <td>{{ course.fecha_fin|date:"d/m/Y" }}</td>
            <td>
              {% if course.status == "pending" %}
                <span class="tag pending">Pendiente</span>
              {% elif course.status == "approved" %}
                <span class="tag active">Activo</span>
              {% else %}
                <span class="tag rejected">Rechazado</span>
              {% endif %}
            </td>
            <td>0/25</td>
            <td>
              <a href="{{ course.registrationLink }}" target="_blank">Link</a>
            </td>
            <td>
              <form method="post" action="#">
                {% csrf_token %}
                <button type="submit" class="btn-solicitar">Solicitar</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% endif %}
</div>
{% endblock %}
